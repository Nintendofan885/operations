#   -------------------------------------------------------------
#   Eglide â€” nginx configuration
#   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#   Project:        Eglide
#   Created:        2016-07-26
#   License:        Trivial work, not eligible to copyright
#   -------------------------------------------------------------

#   -------------------------------------------------------------
#   Main vhost receives special responsibilities like serving
#   user directories.
#   -------------------------------------------------------------

    server {

        listen       80;
        listen       [::]:80;
        server_name  localhost eglide eglide.org eglide.nasqueron.org www.eglide.org [2001:470:1f12:896::2] [2001:470:1f13:896:0:c0de:15:11fe];
        root         /var/www/html;

        access_log   /var/log/www/eglide.org/www-access.log main;
        error_log    /var/log/www/eglide.org/www-error.log;

        ###
        ### SSL
        ###

        include includes/letsencrypt.conf;

        # Once the first certificate has been generated, we'll enabl this snippet:
        #
        # SSL - include ssl_params;
        # SSL - ssl_certificate     /usr/local/etc/letsencrypt/live/eglide.org/fullchain.pem;
        # SSL - ssl_certificate_key /usr/local/etc/letsencrypt/live/eglide.org/privkey.pem;

        ###
        ### Main site
        ###

        location / {
            index index.html index.htm default.html default.htm;
        }

        error_page 500 502 503 504 /50x.html;

        ###
        ### public_html user directories
        ###

        set $userdir public_html;

        location ~ ^/~(.+?)(/.*)?$ {
            alias /home/$1/$userdir$2;
            index index.html index.htm;
            autoindex on;
        }

    }
